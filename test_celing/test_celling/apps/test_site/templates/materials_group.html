{% extends "base.html" %}

{% block title %}Группы материалов{% endblock %}
{% block content %}
    <div class="container-fluid">
        <h1>Группы материалов</h1>
        <div class="row">
        <div class="col-sm-2"></div>
        <div class="col-sm-8">
            <table id="materials_group_table">
                <thead>
                    <td>id</td>
                    <td>Имя</td>
                    <td>Базовая цена</td>
                    <td>Цвета</td>
                </thead>
                <tfoot>
                    <td>id</td>
                    <td>Имя</td>
                    <td>Базовая цена</td>
                    <td>Цвета</td>
                </tfoot>
            </table>
        </div>
        <div class="col-sm-2"></div>
        </div>

  </div>

{% endblock %}

{% block custom_script %}
    <script type="text/javascript">
        $(document).ready(function(){
            $('#materials_group_table').DataTable({
                ajax: '/materials_groups_json',
                "order": [[ 0, "desc" ]],
                "lengthMenu": [[20,50, 100, 200, -1], [20,50, 100, 200, "All"]],
                "language": {
                    "lengthMenu": "_MENU_ записей на странице",
                    "zeroRecords": "0 строк нашли",
                    "info": "Показаны страницы _PAGE_ из _PAGES_",
                    "infoEmpty": "Строки не найдены",
                    "search":    "Поиск: ",
                    "infoFiltered": "(Отфильтрованный от _MAX_ Всего записей)",
                    "paginate": {
                        "first":      "Первый",
                        "last":       "Последний",
                        "next":       "Следующий",
                        "previous":   "Предыдуший"
                    },
                },
                responsive: true,
                "columns": [{
                    "data": 'id'
                }, {
                    "data": 'name'
                }, {
                    'data': "default_price"
                }, {
                    'data': function(row,type,val,meta){
                        let result = '';
                        for(color of JSON.parse(row.colors)){
                            result += color.fields.name + ','
                        }
                        return result.slice(0,result.length-1);
                    }
                }]
            });
        });
    </script>
{% endblock %}